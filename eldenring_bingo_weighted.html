<html>
    <head>
        <style>
            body {
                background-color: #121212;
                color: whitesmoke;
            }
            table, td {
                border: 1px solid #ddd;
                text-align: center;
            }
            table {
                table-layout: fixed;
                border-collapse: collapse;
            }
            td {
                width: 160px;
                max-width: 160px;
                height: 100px;
                max-height: 100px;
                padding: 15px;
                text-align: center;
                user-select: none;
                word-wrap: break-word
            }
            div#page {
                width: 800px;
                margin: 0 auto;
            }
        </style>
    </head>
    <body onload="generateBingoSheet()">
        <div id="page">
            <div id="bingo_grid"></div>
            <br />
            <button id="generate_button" onClick="generateBingoSheet()">Generate new card</button>
            <img src="https://static-cdn.jtvnw.net/emoticons/v2/emotesv2_e02650251d204198923de93a0c62f5f5/static/light/3.0" />
            <br /><br /><br />
            <div>
                <label for="bingo_sync">Bingosync:</label><br />
                <textarea id="bingo_sync"></textarea>
            </div>
        </div>
    </body>

    <script>
        const GREEN = '#072';
        const RED = '#501';

        const WEAPONS = { weight: 1, entries: ["Blasphemous Blade","Bolt of Gransax","Dark Moon Greatsword","Death's Poker","Eleonora's Poleblade","Erdtree Bow","Fallingstar Beast Jaw","Full Moon Crossbow","Godslayer's Greatsword","Lion Greatbow","Meteoric Ore Blade","Mohgwyn's Sacred Spear","Moonveil","Onyx Lord's Greatsword","Rivers of Blood","Scepter of the All-Knowing","Sword of Night and Flame","Winged Scythe","Carian Regal Scepter","Dragon Communion Seal","Frenzied Flame Seal","Giant's Seal","Lusat's Glintstone Staff","Bastard's Stars","Beastclaw Greathammer","Black Knife","Blade of Calling","Carian Knight's Sword","Cranial Vessel Candlestand","Crystal Sword","Death Ritual Spear","Devourer's Scepter","Dragon Greatclaw","Dragon King's Cragblade","Eclipse Shotel","Envoy's Greathorn","Envoy's Horn","Envoy's Long Horn","Executioner's Greataxe","Family Heads","Giant's Red Braid","Golden Halberd","Grafted Blade Greatsword","Grafted Dragon","Halo Scythe","Hand of Malenia","Helphen's Steeple","Horn Bow","Inquisitor's Girandole","Inseparable Sword","Lazuli Glintstone Sword","Magma Blade","Magma Wyrm's Scalesword","Marais Executioner's Sword","Miquellan Knight's Sword","Morgott's Cursed Sword","Prelate's Inferno Crozier","Royal Greatsword","Ruins Greatsword","Sacred Relic Sword","Siluria's Tree","Staff of the Avatar","Sword of St Trina","Treespear","Veteran's Prosthesis","Wing of Astel","Azur's Glintstone Staff","Godslayer's Seal","Golden Order Seal","Gravel Stone Seal","Rotten Crystal Staff","Antspur Rapier","Axe of Godrick","Beast-Repellent Torch","Clayman's Harpoon","Crystal Spear","Frozen Needle","Gargoyle's Black Axe","Gargoyle's Black Halberd","Gargoyle's Blackblade","Ghostflame Torch","Glintstone Kris","Golden Order Greatsword","Golem Greatbow","Great Omenkiller Cleaver","Greataxe","Hammer","Ivory Sickle","Loretta's War Sickle","Magma Whip Candlestick","Marika's Hammer","Monk's Flamemace","Noble's Slender Sword","Nox Flowing Hammer","Reduvia","Ringed Finger","Rogier's Rapier","Rosus' Axe","Rotten Crystal Spear","Rusted Anchor","Sentry's Torch","St. Trina's Torch","Starscourge Greatsword","Stone Club","Torchpole","Troll Knight's Sword","Vyke's War Spear","Winged Greathorn","Academy Glintstone Staff","Demi-Human Queen's Staff","Gelmir Glintstone Staff","Meteorite Staff","Staff of Loss","Staff of the Guilty","Albinauric Bow","Axe of Godfrey","Bandit's Curved Sword","Bloodhound Claws","Cinquedea","Crystal Knife","Curved Club","Duelist Greataxe","Grave Scythe","Grossmesser","Hoslow's Petal Whip","Jar Cannon","Longhaft Axe","Mace","Morning Star","Ordovis's Greatsword","Regalia of Eochaid","Rotten Crystal Sword","Rotten Greataxe","Rotten Staff","Spiked Club","Steel-Wire Torch","Torch","Troll's Hammer","Warpick","Watchdog's Staff","Finger Seal","Alabaster Lord's Sword","Beastman's Cleaver","Beastman's Curved Sword","Bloodhound's Fang","Butchering Knife","Celebrant's Skull","Chainlink Flail","Cleanrot Knight's Sword","Club","Cross-Naginata","Curved Great Club","Erdtree Greatbow","Falchion","Flail","Flowing Curved Sword","Ghiza's Wheel","Giant-Crusher","Golem's Halberd","Great Club","Great Stars","Greatbow","Iron Spear","Longbow","Mantis Blade","Misericorde","Nightrider Flail","Nox Flowing Sword","Omen Cleaver","Partisan","Pickaxe","Pike","Pulley Bow","Scavenger's Curved Sword","Scimitar","Serpent-God's Curved Sword","Shamshir","Spear","Spiked Spear","Thorned Whip","Urumi","Venomous Fang","Wakizashi","Whip","Astrologer's Staff","Carian Glintstine Staff","Crystal Staff","Glintstone Staff","Arbalest","Battle Axe","Battle Hammer","Bloodstained Dagger","Bloody Helice","Broadsword","Celebrant's Cleaver","Celebrant's Rib-Rake","Celebrant's Sickle","Commander's Standard","Crepus's Black-Key Crossbow","Dismounter","Dragon Halberd","Estoc","Gargoyle's Halberd","Glaive","Godskin Stitcher","Great Mace","Greathorn Hammer","Greatsword","Guardian's Swordspear","Highland Axe","Hookclaws","Iron Cleaver","Iron Greatsword","Jawbone Axe","Large Club","Monk's Flameblade","Rotten Battle Hammer","Sacrificial Axe","Scorpion's Stinger","Scythe","Serpent Bow","Serpentbone Blade","Short Spear","Shotel","Star Fist","Stormhawk Axe","Troll's Golden Sword","Uchigatana","Warped Axe","Digger's Staff","Prince of Death's Staff","Banished Knight's Greatsword","Banished Knight's Halberd","Bastard Sword","Black Bow","Brick Hammer","Caestus","Cane Sword","Cipher Pata","Claymore","Clinging Bone","Coded Sword","Composite Bow","Dagger","Dragonscale Blade","Erdsteel Dagger","Flamberge","Forked Greatsword","Forked Hatchet","Gargoyle's Great Axe","Gargoyle's Greatsword","Gargoyle's Twinblade","Godskin Peeler","Great Epee","Great Knife","Halberd","Hand Axe","Hand Ballista","Harp Bow","Heavy Crossbow","Icerind Hatchet","Iron Ball","Katar","Knight's Greatsword","Lance","Light Crossbow","Longsword","Lordsworn's Greatsword","Lordsworn's Straight Sword","Lucerne","Maliketh's Black Blade","Misbegotten Shortbow","Nagakiba","Nightrider Glaive","Noble's Estoc","Ornamental Straight Sword","Parrying Dagger","Pest's Glaive","Pulley Crossbow","Rapier","Raptor Talons","Red Branch Shortbow","Ripple Blade","Ripple Crescent Halberd","Serpent-Hunter","Short Sword","Shortbow","Soldier's Crossbow","Spiked Caestus","Sword of Milos","Twinblade","Twinned Knight Swords","VarrÃ©'s Bouquet","Vulgar Militia Saw","Vulgar Militia Shotel","Warhawk's Talon","Watchdogs Greatsword","Weathered Straight Sword","Winged Spear","Zamor Curved Sword","Zweihander","Clawmark Seal","Erdtree Seal","Albinauric Staff","Carian Glintblade Staff","Beastman's Jar-Shield","Coil Shield","Spiralhorn Shield","Shield of the Guilty","Smoldering Shield","Pillory Shield","Perfumer's Shield","Red Thorn Roundshield","Rift Shield","Riveted Wooden Shield","Scripture Wooden Shield","Buckler","Gilded Iron Shield","Iron Roundshield","Man-Serpent's Shield","Rickety Shield","Blue-White Wooden Shield","Ice Crest Shield","Brass Shield","Banished Knight's Shield","Blue-Gold Kite Shield","Inverted Hawk Heater Shield","Albinauric Shield","Scorpion Kite Shield","Eclipse Crest Heater Shield","Kite Shield","Great Turtle Shell","Blue Crest Heater Shield","Red Crest Heater Shield","Round Shield","Twinbird Kite Shield","Beast Crest Heater Shield","Silver Mirrorshield","Large Leather Shield","Sun Realm Shield","Black Leather Shield","Candletree Wooden Shield","Flame Crest Wooden Shield","Hawk Crest Wooden Shield","Heater Shield","Horse Crest Wooden Shield","Carian Knight's Shield","Marred Leather Shield","Fingerprint Stone Shield","Haligtree Crest Greatshield","Visage Shield","Crossed-Tree Towershield","Distinguished Greatshield","Dragon Towershield","Golden Greatshield","Inverted Hawk Towershield","Gilded Greatshield","One-Eyed Shield","Cuckoo Greatshield","Eclipse Crest Greatshield","Erdtree Greatshield","Manor Towershield","Redmane Greatshield","Dragonclaw Shield","Crucible Hornshield","Golden Beast Crest Shield","Jellyfish Shield","Lordsworn's Shield","Spiked Palisade Shield","Ant's Skull Plate","Briar Greatshield","Icon Shield","Wooden Greatshield"] };
        const ARMOR_SETS = { weight: 1, entries: ["Alberich's Set","Black Knife Set","Raya Lucarian Sorcerer Set","Lusat's Set","Mushroom Set","General Radahn Set","Snow Witch Set","Spellblade Set","Azur's Glintstone Set","Banished Knight Set","Beast Champion Set","Blackflame Monk Set","Crucible Set","Crucible Tree Set","Fire Prelate Set","Gelmir Knight Set","Godrick Knight Set","Land of Reeds Set","Lionel's Set.","Lionel's Set","Malenia's Set","Malformed Dragon Set","Omen Set","Raging Wolf Set","Royal Knight Set","Royal Remains Set","Ruler's Set","Scaled Set","Tree Sentinel Set","Vagabond Knight Set","Veteran's Set","White Reed Set","All-Knowing Set","Blaidd's Set","Bloodhound Knight Set","Blue Silver Set","Brave's Set","Briar Set","Bull-Goat Set","Carian Knight Set","Chain Set","Cleanrot Set","Raya Lucarian Soldier Set","Drake Knight Set","Duelist Set","Eccentric Set","Elden Lord Set","Exile Set","Fire Monk Set","Godrick Armor Set","Haligtree Set","Hoslow's Set","Iron Set","Kaiden Set","Knight Set","Leyndell Soldier Set","Maliketh's Set","Marionette Set","Night's Cavalry Set","Prisoner Set","Radahn Soldier Set","Raya Lucarian Set","Redmane Knight Set","Rotten Duelist Set","Twinned Set","Zamor Set","Aristocrat Set","Cuckoo Knight Set","Fingerprint Set","Godrick Soldier Set","Haligtree Set.","Haligtree Knight Set","Leyndell Knight Set","Mausoleum Set","Mausoleum Knight Set","Noble's Set","Omenkiller Set","Ragged Set","Redmane Knight set","Ronin's Set","Sage Set","Blue Cloth Set","Bandit Set","Battlemage Set","Foot Soldier Set","Confessor Set","Consort's Set","Errant Sorcerer Set","Finger Maiden Set","Godskin Apostle Set","Gold Set","Guardian Set","Highwayman Set","Leather Set","Nomadic Merchant's Set","Nox Monk Set","Old Aristocrat Set","Page Set","Prophet Set","Sacred Crown","Sanguine Noble Set","Shaman Set","Melina's Set","Traveler's Set","Traveling Maiden Set","Vulgar Militia Set","Warrior Armor Ses","Astrologer Set","Black Set","Bloodsoaked Set","Champion Set","Cloth Set","Commoner's Set","Depraved Perfumer Set","Envoy Set","Fia's Set","Fur Set","Godskin Noble Set","Juvenile Scholar Set","House Marais Set","Millicent's Set","Erdtree Capital Set","Preceptor's Set","Queen of the Full Moon Set","Traveler Set","War Surgeon Set","Festive Set","Commoners of the Lands Between Set","Deathbed Set","Goldmask's Set","High Page Set","Perfumer Set"]};
        const SPELLS = { weight: 1, entries: ["Black Blade","Bloodboon","Burn O Flame!","Carian Retaliation","Comet Azur","Death Lightning","Elden Stars","Eternal Darkness","Flame Fortification","Fortissax's Lightning Spear","Golden Vow","Placidusax's Ruin","Protection of the Erdtree","Ranni's Dark Moon","Rennala's Full Moon","Rykard's Rancor","Scarlet Aeonia","The Flame of Frenzy","Agheel's Flame","Ambush Shard","Assassin's Approach","Divine Fortification","Dragonfire","Ekzykes's Decay","Electrify Armament","Flame Grant me Strength","Flame Protect Me","Frozen Armament","Gravity Well","Great Heal","Lansseax's Glaive","Law of Regression","Lightning Spear","Litany of Proper Death","Lord's Aid","Loretta's Greatbow","Order's Blade","Theodorix's Magma","Unseen Blade","Urgent Heal","Vyke's Dragonbolt","Whirl O Flame!","Wrath of Gold","Barrier of Gold","Bestial Constitution","Black Flame","Black Flame Blade","Black Flame Ritual","Bloodflame Blade","Borealis's Mist","Carian Phalanx","Carian Slicer","Comet","Dragonice","Flame Cleanse Me","Founding Rain of Stars","Glintblade Phalanx","Glintstone Icecrag","Glintstone Pebble","Golden Lightning Fortification","Great Glintstone Shard","Gurrang's Beast Claw","Howl of Shabriri","Immutable Shield","Law of Causality","Lightning Fortification","Lightning Strike","Lord's Divine Fortification","Lord's Heal","Magic Fortification","Meteorite of Astel","Rotten Breath","Scholar's Armament","Smarag's Glintstone Breath","Star Shower","Stone of Gurranq","Surge O Flame!","Swift Glintstone Shard","Blessing of the Erdtree","Crystal Release","Crystal Torrent","Cure Poison","Erdtree Heal","Explosive Ghostflame","Flame of the Fell God","Glintstone Cometshard","Glintstone Stars","Greyoll's Roar","Heal","Loretta's Mastery","Lucidity","Magma Breath","Scholar's Shield","Stars of Ruin","Unseen Form","Ancient Death Rancor","Blessing's Boon","Bloodflame Talons","Collapsing Stars","Crystal Barrage","Darkness","Discus of Light","Dragonbolt Blessing","Dragonclaw","Fire's Deadly Sin","Freezing Mist","Frozen Lightning Spear","Magic Downpour","Night Comet","Night Maiden's Mist","Pest Threads","Poison Armament","Shadow Bait","Shattering Crystal","Thops's Barrier","Triple Rings of Light","Zamor Ice Storm","Adula's Moonblade","Ancient Dragons' Lightning Spear","Ancient Dragons' Lightning Strike","Aspect of the Crucible Breath","Aspect of the Crucible Tail","Aspects of the Crucible Horns","Black Flame's Protection","Cannon of Haima","Carian Piercer","Flame Fall Upon Them","Gavel of Haima","Gelmir's Fury","Giantsflame Take Thee","Glintstone Breath","Great Oracular Bubble","Greatblade Phalanx","Meteorite","Noble Presence","Order Healing","Radagon's Rings of Light","Scouring Black Flame","Shard Spiral","Tibia's Summons","Unendurable Frenzy","Beast Claw","Bestial Sling","Bestial Vitality","Briars of Punishment","Briars of Sin","Carian Greatsword","Catch Flame","Crystal Burst","Dragonmaw","Fia's Mist","Flame Sling","Frenzied Burst","Glintstone Arc","Honed Bolt","Inescapable Frenzy","Magic Bubble","Magic Glintblade","Magma Shot","Night Shard","O Flame!","Oracle Bubbles","Poison Mist","Rancorcall","Rejection","Rock Blaster","Rock Sling","Roiling Magma","Shatter Earth","Starlight","Swarm of Flies","Terra Magicus"]};
        const ASHES = { weight: 1, entries: ["Azula Beastman Ashes","Greatshield Soldier Ashes","Lhutel the Headless","Mimic Tear Ashes","Nightmaiden & Swordtress Puppets","Radahn Soldier Ashes","Ancient Dragon Knight Kristoff Ashes","Black Knife Tiche","Dung Eater Puppet","Fanged Imp Ashes","Godrick Soldier Ashes","Nepheli Loux Puppet","Oracle Envoy Ashes","Spirit Jellyfish Ashes","Leyndell Soldier Ashes","Lone Wolf Ashes","Mausoleum Soldier Ashes","Omenkiller Rollo","Raya Lucaria Soldier Ashes","Albinauric Ashes","Avionette Soldier Ashes","Banished Knight Engvall Ashes","Banished Knight Oleg Ashes","Demi-Human Ashes","Mad Pumpkin Head Ashes","Man-Serpent Ashes","Stormhawk Deenh","Vulgar Militia Ashes","Ancestral Follower Ashes","Archer Ashes","Clayman Ashes","Depraved Perfumer Carmaan Ashes","Finger Maiden Therolina Puppet","Fire Monk Ashes","Giant Rat Ashes","Kindred of Rot Ashes","Marionette Soldier Ashes","Noble Sorcerer Ashes","Nomad Ashes","Page Ashes","Soldjars of Fortune Ashes","Twinsage Sorcerer Ashes","Warhawk Ashes","Battlemage Hugues Ashes","Blackflame Monk Amon Ashes","Bloodhound Knight Floh","Cleanrot Knight Finlay Ashes","Crystalian Ashes","Dolores the Sleeping Arrow Puppet","Glintstone Sorcerer Ashes","Haligtree Soldier Ashes","Jarwight Puppet","Kaiden Sellsword Ashes","Land Squirt Ashes","Latenna the Albinauric","Miranda Sprout Ashes","Perfumer Tricia","Putrid Corpse Ashes","Redmane Knight Ogha","Rotten Stray Ashes","Skeletal Bandit Ashes","Skeletal Militiaman Ashes","Wandering Noble Ashes","Winged Misbegotten Ashes"]};
        const BOSSES = { weight: 5, entries: ["Abductor Virgins","Adan, Thief of Fire","Alabaster Lord","Alecto, Black Knife Ringleader","Ancestor Spirit","Ancient Dragon Lansseax","Ancient Hero of Zamor","Astel, Naturalborn of the Void","Astel, Stars of Darkness","Battlemage Hugues","Beast Clergyman","Beast of Farum Azula","Bell Bearing Hunter","Black Blade Kindred","Black Knife Assassin","Bloodhound Knight Darriwil","Bols, Carian Knight","Borealis the Freezing Fog","Cemetery Shade","Cleanrot Knight","Commander Niall","Commander O'Neil","Crucible Knight","Crucible Knight Ordovis","Crucible Knight Siluria","Crystalian Ringblade","Crystalian Spear &amp; Crystalian Ringblade","Crystalian Spear &amp; Crystalian Staff","Crystalians","Death Rite Bird","Deathbird","Decaying Ekzykes","Demi-Human Chief","Demi-Human Queen Gilika","Demi-Human Queen Maggie","Demi-Human Queen Margot","Divine Bridge Golem","Draconic Tree Sentinel","Dragonkin Soldier","Dragonkin Soldier of Nokstella","Dragonlord Placidusax","Elden Beast","Elder Dragon Greyoll","Elemer of the Briar","Erdtree Avatar","Erdtree Burial Watchdog","Esgar, Priest of Blood","Fallingstar Beast","Fell Twins","Festering Fingerprint Vyke","Fia's Champions","Fire Giant","Flying Dragon Agheel","Flying Dragon Greyll","Frenzied Duelist","Full-Grown Fallingstar Beast","Glinstone Dragon Adula","Glintstone Dragon Smarag","God-Devouring Serpent","Godefroy the Grafted","Godfrey, First Elden Lord","Godfrey, First Elden Lord Hoarah Loux","Godrick the Grafted","Godskin Apostle","Godskin Duo","Godskin Noble","Golem Archer","Grafted Scion","Grave Warden Duelist","Great Wyrm Theodorix","Guardian Golem","Kindred of Rot","Leonine Misbegotten","Lichdragon Fortissax","Lion Guardian","Loretta, Knight of the Haligtree","Mad Pumpkin Head","Magma Wyrm","Magma Wyrm Makar","Malenia, Blade of Miquella","Maliketh, The Black Blade","Margit, the Fell Omen","Mimic Tear","Miranda the Blighted Bloom","Misbegotten Crusader","Misbegotten Warrior","Mohg, Lord of Blood","Mohg, the Omen","Morgott, The Omen King","Necromancer Garris","Night's Cavalry","Nox Swordstress &amp; Nox Priest","Omenkiller","Onyx Lord","Patches","Perfumer Tricia","Putrid Avatar","Putrid Crystalian Trio","Putrid Grave Warden Duelist","Putrid Tree Spirit","Radagon of the Golden Order","Red Wolf of Radagon","Red Wolf of the Champion","Regal Ancestor Spirit","Rennala, Queen of the Full Moon","Royal Knight Loretta","Royal Revenant","Runebear","Rykard, Lord of Blasphemy","Sanguine Noble","Scaly Misbegotten","Sir Gideon Ofnir, The All-Knowing","Soldier of Godrick","Spirit-Caller Snail","Starscourge Radahn","Stonedigger Troll","Tibia Mariner","Tree Sentinel","Tree Sentinel Duo","Twinblade Gargoyle","Ulcerated Tree Sprit","Valiant Gargoyle","Valiant Gargoyle Twinblade","Vyke, Knight of the Roundtable","Wormface"]};
        const TALISMANS = { weight: 1, entries: ["Ancestral Spirit's Horn","Erdtree's Favor","Flock's Canvas Talisman","Golden Scarab","Graven-Mass Talisman","Lord of Blood's Exultation","Radagon Icon","Shard of Alexander","Silver Scarab","Winged Sword Insignia","Arrow's Reach Talisman","Carian Filigreed Crest","Concealing Veil","Crucible Feather Talisman","Dagger Talisman","Faithful Canvas Talisman","Godfrey Icon","Godskin Swaddling Cloth","Graven-School Talisman","Kindred of Rot's Exultation","Magic Scorpion Charm","Marika's Soreseal","Millicent's Prosthesis","Old Lord's Talisman","Pearldrake Talisman","Red-Feathered Branchsword","Ritual Sword Talisman","Rotten Winged Sword Insignia","Stalwart Horn Charm","Warrior Jar Shard","Arrow's Sting Talisman","Arsenal Charm","Assassin's Cerulean Dagger","Axe Talisman","Blue Dancer Charm","Crimson Seed Talisman","Dragoncrest Greatshield Talisman","Great-Jar's Arsenal","Green Turtle Talisman","Host's Trick-Mirror","Immunizing Horn Charm","Lightning Scorpion Charm","Moon of Nokstella","Primal Glintstone Blade","Sacred Scorpion Charm","Spear Talisman","Stargazer Heriloom","Twinblade Talisman","Assassin's Crimson Dagger","Blue-Feathered Branchsword","Boltdrake Talisman","Bull-Goat's Talisman","Cerulean Amber Medallion","Clarifying Horn Charm","Crepus's Vial","Crimson Amber Medallion","Fire Scorpion Charm","Flamedrake Talisman","Furled Finger's Trick-Mirror","Haligdrake Talisman","Hammer Talisman","Longtail Cat Talisman","Mottled Necklace","Perfumer's Talisman","Prince of Death's Pustule","Prosthesis-Wearer Heirloom","Ritual Shield Talisman","Sacrificial Twig","Shabriri's Woe","Spelldrake Talisman","Starscourge Heirloom","Two Fingers Heirloom","Viridian Amber Medallion","Blessed Dew Talisman","Companion Jar","Crucible Scale Talisman","Roar Medallion","Taker's Cameo","Cerulean Seed Talisman","Crepu's Vial","Crucible Knot Talisman","Curved Sword Talisman","Dragoncrest Shield Talisman","Greatshield Talisman","Lance Talisman","Marika's Scarseal","Radagon's Scarseal","Radagon's Soreseal","Claw Talisman","Daedicar's Woe","Entwining Umbilical Cord"]};
        const ITEMS = { weight: 5, entries: ["Crafting Kit", "Tailoring Tools", "Golden Tailoring Tools", "Sewing Needle", "Gold Sewing Needle", "1 Memory Stone", "3 Memory Stones", "5 Memory Stones", "3 Talisman Pouches", "5 Cracked Pot", "10 Cracked Pot", "15 Cracked Pot", "5 Ritual Pot", "5 Perfume Bottle", "10 Stonesword Keys", "30 Stonesword Keys", "40 Stonesword Keys", "2 Imbued Swordstone Keys", "Ascend Dectus Lift", "Unlock 5 Maps", "Unlock 10 Maps", "Unlock 15 Maps"]};
        const QUESTS = { weight: 5, entries: ["Power Up Godrick Rune", "Power Up Malenia Rune", "Power Up Radahn Rune", "Power Up Morgott Rune", "Power Up Rykard Rune", "Power Up Mohg Rune", "Varre Questline", "Boc Questline", "Roderika Questline", "D Questline", "Gurranq Questline", "Thops Questline", "Hyetta Questline", "Kenneth  Questline", "Ranni Questline", "Alexander Questline", "Blaidd Questline", "Fia Questline", "Sellen Questline", "Gowry Questline", "Corhyn Questline", "Nepheli Questline", "Seluvis Questline", "Yura Questline", "Bernahl Questline", "Patches Questline", "Rya Questline", "Dung Eater Questline", "Millicent Questline", "Big Boggart Questline", "Latenna Questline", "Rogier Questline", "Diallos Questline", "Tanith Questline"]};
        const EXPLORATION = { weight: 5, entries: ["40 Sites of Grace", "80 Sites of Grace", "120 Sites of Grace", "7 Underground Locations", "7 Limgrave Locations", "7 Weeping Penis Locations", "7 Liurnia Locations", "7 Caelid Locations", "7 Atlus Locations", "7 Gelmir Locations", "7 Dragonbarrow Locations", "7 Mountaintop Locations", "7 Consecrated Snowfield Locations", "Collect 20 Spirit Ashes", "Collect 40 Spirit Ashes"]};

        const BINGO_CATEGORIES = [WEAPONS, ARMOR_SETS, SPELLS, ASHES, BOSSES, TALISMANS, ITEMS, QUESTS, EXPLORATION];

        function weightedRandomBingoPick() {
            const sumOfWeights = BINGO_CATEGORIES.reduce((prev, curr) => prev += curr.weight, 0);
            let randomNum = Math.random() * sumOfWeights;

            for (const category of BINGO_CATEGORIES) {
                if (randomNum < category.weight) {
                    return category.entries[Math.floor(Math.random() * category.entries.length)];
                }

                randomNum -= category.weight;
            }
        }

        function generateBingoSheet() {
            if (document.getElementById('bingo_table')) {
                const table = document.getElementById('bingo_table');
                table.remove();
            }
            const bingoDiv = document.getElementById('bingo_grid');

            // create the bingo table
            const bingoGrid = document.createElement('table');
            bingoGrid.setAttribute('id', 'bingo_table');
            const addedBingoEntries = [];
            const bingoSync = [];

            for (var rows = 1; rows < 6; rows++) {
                const row = document.createElement('tr');
                row.setAttribute('id', 'row' + rows);
                bingoGrid.appendChild(row);

                for (var col = 1; col < 6; col++) {
                    const bingoCell = document.createElement('td');
                    bingoCell.setAttribute('id', 'cell' + rows + '' + col);
                    bingoCell.onclick = function () { onCellClick(this) };

                    let foundUniqueBingoEntry = false;
                    while (!foundUniqueBingoEntry) {
                        const bingoEntry = weightedRandomBingoPick();

                        if (!addedBingoEntries.find(entry => entry == bingoEntry)) {
                            bingoCell.innerHTML = bingoEntry;
                            row.appendChild(bingoCell);
                            addedBingoEntries.push(bingoEntry);
                            bingoSync.push({ name: bingoEntry });
                            foundUniqueBingoEntry = true;
                        }
                    }
                }
            }
            
            bingoDiv.appendChild(bingoGrid);

            const bingoSyncTextArea = document.getElementById('bingo_sync');
            bingoSyncTextArea.innerHTML = JSON.stringify(bingoSync);
        }

        function onCellClick(cell) {
            const cellColor = cell.getAttribute('bgcolor');

            if (cellColor == GREEN) {
                cell.setAttribute('bgcolor', RED);
            } else if (cellColor == RED) {
                cell.setAttribute('bgcolor', '');
            } else {
                cell.setAttribute('bgcolor', GREEN);
            }
            
        }
    </script>
</html>